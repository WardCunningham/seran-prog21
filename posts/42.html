<!DOCTYPE html><html lang="en"><head><title>Digging Deeper into Sufficiently Smartness</title><link rel="alternate" type="application/atom+xml" title="Atom feed" href="atom.xml"><meta name="viewport" content="width=device-width,initial-scale=1"><style>a,#p21{text-decoration:none}a:link{color:#00D}a:visited{color:purple}a:hover{text-decoration:underline}body,div{margin:0;padding:0;box-sizing:border-box}body{font:100%/1.5 verdana;color:#222}p,ul,blockquote,pre{margin:0 0 1em}ul{list-style:none;padding-left:1em;text-indent:-1em}h1,h2{font:700 1.27em verdana;margin:0 0 .5em}h1{color:#117}blockquote{font-style:italic}pre,code{font:700 1em "courier new",monospace}pre{overflow:auto}.box{margin:0 auto;padding:0 12px}.s{font:.91em/1.4 verdana}.ab a{display:block;margin:0 0 1em;padding-left:1em;text-indent:-1em}#top{background:#117;color:#FFF;margin:0 0 .67em;border:0 solid #7373D9;border-width:0 0 12px;padding:2em 0 0}#p21{font:700 2.5em georgia;color:#FFF}#perm{color:#222;background:#DDD;border:1px solid #BBB;padding:2px}@media screen and (min-width:768px){blockquote,pre{margin-left:1.25em}.box{max-width:840px}#c1{width:71%;float:left}#c2{width:26%;float:right}}</style></head><body><div id="top"><div class="box"><a id="p21" href="/">programming in&nbsp;the<br>twenty-first century</a><p>It's not about technology for its own sake. It's about being able to implement your ideas.</p></div></div><div class="box"><div id="c1"><h1>Digging Deeper into Sufficiently Smartness</h1><p>(If you haven't read <a href="40.html">On Being Sufficiently Smart</a>, go ahead and do so, otherwise this short note won't have any context.)</p><p>I frequently write Erlang code that builds a list which ends up backward, so I call <code>lists:reverse</code> at the very end to flip it around.  This is a common idiom in functional languages.</p><p><code>lists:reverse</code> is a built-in function in Erlang, meaning it's implemented in C, but for the sake of argument let's say that it's written in Erlang instead.  This is super easy, so why not?</p><pre>reverse(L) -&gt; reverse(L, []).
reverse([H|T], Acc) -&gt;
   reverse(T, [H|Acc]);
reverse([], Acc) -&gt;
   Acc.</pre><p>Now suppose there's another function that uses <code>reverse</code> at the very end, just before returning:</p><pre>collect_digits(L) -&gt; collect_digits(L, []).
collect_digits([H|T], Acc) when H &gt;= $0, H =&lt; $9 -&gt;
   collect_digits(T, [H|Acc]);
collect_digits(_, Acc) -&gt;
   reverse(Acc).</pre><p>This function returns a list of ASCII digits that prefix a list, so <code>collect_digits("1234.0")</code> returns <code>"1234"</code>.  And now one more "suppose": suppose that one time we decide that we really need to process the result of <code>collect_digits</code> backward, so we do this:</p><pre>reverse(collect_digits(List))</pre><p>The question is, can the compiler detect that there's a double reverse?  In theory, the last <code>reverse</code> could be dropped from <code>collect_digits</code> in the generated code, and each call to <code>collect_digits</code> could be automatically wrapped in a call to <code>reverse</code>.  If there ends up being two calls to <code>reverse</code>, then get rid of both of them, because it's just wasted effort to double-reverse a list.</p><p>With <code>lists:reverse</code> as a built-in, this is easy enough.  But can it be deduced simply from the raw source code that <code>reverse(reverse(List))</code> can be replaced with <code>List</code>?  Is that effort easier than simply special-casing the list reversal function?</p><p class="s"><a href="42.html" id="perm">permalink</a> <i>June 14, 2009</i></p><h1>previously</h1><ul><li><a href=41.html>Let's Take a Trivial Problem and Make it Hard</a><li><a href=40.html>On Being Sufficiently Smart</a><li><a href=39.html>How My Brain Kept Me from Co-Founding YouTube</a><li><a href=38.html>Puzzle Languages</a><li><a href=37.html>Revisiting "Purely Functional Retrogames"</a></ul></div><div id="c2"><h1><a href="archives.html">archives</a></h1><p><b><a href="https://twitter.com/dadgumjames">twitter</a></b> / <b><a href="mailto:james.hague@gmail.com">mail</a></b></p><div class="s"><p>I'm James Hague, a <a href="56.html">recovering programmer</a> who has been designing video games since the 1980s. <a href="195.html">Programming Without Being Obsessed With Programming</a> and <a href="177.html">Organizational Skills Beat Algorithmic Wizardry</a> are good starting points. For the older stuff, try the <a href="162.html">2012 Retrospective</a>.</p><p>Where are <a href="57.html">the comments</a>?</p></div></div></div>
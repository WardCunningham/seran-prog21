<!DOCTYPE html><html lang="en"><head><title>Don't Structure Data All The Way Down</title><link rel="alternate" type="application/atom+xml" title="Atom feed" href="atom.xml"><meta name="viewport" content="width=device-width,initial-scale=1"><style>a,#p21{text-decoration:none}a:link{color:#00D}a:visited{color:purple}a:hover{text-decoration:underline}body,div{margin:0;padding:0;box-sizing:border-box}body{font:100%/1.5 verdana;color:#222}p,ul,blockquote,pre{margin:0 0 1em}ul{list-style:none;padding-left:1em;text-indent:-1em}h1,h2{font:700 1.27em verdana;margin:0 0 .5em}h1{color:#117}blockquote{font-style:italic}pre,code{font:700 1em "courier new",monospace}pre{overflow:auto}.box{margin:0 auto;padding:0 12px}.s{font:.91em/1.4 verdana}.ab a{display:block;margin:0 0 1em;padding-left:1em;text-indent:-1em}#top{background:#117;color:#FFF;margin:0 0 .67em;border:0 solid #7373D9;border-width:0 0 12px;padding:2em 0 0}#p21{font:700 2.5em georgia;color:#FFF}#perm{color:#222;background:#DDD;border:1px solid #BBB;padding:2px}@media screen and (min-width:768px){blockquote,pre{margin-left:1.25em}.box{max-width:840px}#c1{width:71%;float:left}#c2{width:26%;float:right}}</style></head><body><div id="top"><div class="box"><a id="p21" href="/">programming in&nbsp;the<br>twenty-first century</a><p>It's not about technology for its own sake. It's about being able to implement your ideas.</p></div></div><div class="box"><div id="c1"><h1>Don't Structure Data All The Way Down</h1><p>Let's write some functions to operate on circles, where a circle is a defined by a 2D center point and a radius.  In Erlang we've got some options for how to represent a circle:</p><pre>{X, Y, R}                     % raw tuple
{circle, X, Y, R}             % tagged tuple
#circle{x = X, y = Y, r = R}  % icky record</pre><p>Hmmm...why is a circle represented as a structure, but a point is unwrapped, so to speak, into two values?  Attempt #2:</p><pre>{{X,Y}, R}                    % raw tuples
{circle, {point,X,Y}, R}      % tagged tuples
...                           % gonna stop with records</pre><p>Now let's write a function to compute the area of a circle, using this new representation:</p><pre>area({circle, {point,_X,_Y}, R}) -&gt;
   math:pi() * R * R.</pre><p>Simple enough.  But take a few steps back and look this.  First, we're not actually making use of the structure of the data in <code>area</code>.  We're just <b>de</b>structuring it to get the radius.  And to do that destructuring, there's a bunch of code generated for this function: to verify the parameter is a tuple of size 3, to verify that the first element is the atom <code>circle</code>, to verify the second element is a tuple of size 3 with the atom <code>point</code> as the first element, and to extract the radius.  Then there's a trivial bit of math and we've got an answer.</p><p>Now suppose we want to find the area of a circle of radius 17.4.  We've got a nice function all set to go...sort of.  We need the radius to be part of a circle, so we could try this:</p><pre>area({circle, {point,0,0}, 17.4})</pre><p>Kind of messy.  What about a function to build a circle for us?  Then we could do this:</p><pre>area(make_circle(0, 0, 17.4))</pre><p>We could also have a shorter version of <code>make_circle</code> that only takes a radius, defaulting the center point to 0,0.  Okay, stop, we're engineering ourselves to death.  All we need is a simple function to compute the area of a circle:</p><pre>area(R) -&gt;
   math:pi() * R * R.</pre><p>Resist the urge to wrap it into an abstract data type or an object.  Keep it raw and unstructured and simple.  If you want structure, add it one layer up, don't make it part of the foundation. In fact, I'd go so far as to say that if you pass a record-like data structure to a function and <i>any</i> of the elements in that structure aren't being used, then you should be operating on a simpler set of values and not a data structure.  Keep the data flow obvious.</p><p class="s"><a href="17.html" id="perm">permalink</a> <i>January 20, 2008</i></p><h1>previously</h1><ul><li><a href=16.html>Garbage Collection in Erlang</a><li><a href=15.html>Why Garbage Collection Paranoia is Still (sometimes) Justified</a><li><a href=14.html>Functional Programming Archaeology</a><li><a href=13.html>Would You Bet $100,000,000 on Your Pet Programming Language?</a><li><a href=12.html>Timings and the Punchline</a></ul></div><div id="c2"><h1><a href="archives.html">archives</a></h1><p><b><a href="https://twitter.com/dadgumjames">twitter</a></b> / <b><a href="mailto:james.hague@gmail.com">mail</a></b></p><div class="s"><p>I'm James Hague, a <a href="56.html">recovering programmer</a> who has been designing video games since the 1980s. <a href="195.html">Programming Without Being Obsessed With Programming</a> and <a href="177.html">Organizational Skills Beat Algorithmic Wizardry</a> are good starting points. For the older stuff, try the <a href="162.html">2012 Retrospective</a>.</p><p>Where are <a href="57.html">the comments</a>?</p></div></div></div>